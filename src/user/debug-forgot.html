<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Forgot Password Test</title>
    <style>
        body {
            background: #0F0F23;
            color: white;
            font-family: 'Inter', Arial, sans-serif;
            padding: 20px;
        }
        
        .test-buttons {
            margin: 20px 0;
        }
        
        .test-buttons button {
            background: #5b5ff7;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .test-buttons button:hover {
            background: #4c4ff5;
        }
        
        .debug-info {
            background: #1a1f2e;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üîß Forgot Password Debug Test</h1>
    
    <div class="test-buttons">
        <button onclick="testShowLogin()">üìù Show Login Popup</button>
        <button onclick="testShowForgotPassword()">üîë Show Forgot Password Direct</button>
        <button onclick="testClickForgotLink()">üîó Test Forgot Link Click</button>
        <button onclick="debugElements()">üîç Debug Elements</button>
        <button onclick="testInitAuth()">üöÄ Test Init Auth</button>
    </div>
    
    <div id="debug-output" class="debug-info">
        <div id="debug-text">Debug output will appear here...</div>
    </div>
    
    <script>
        function log(message) {
            const debugText = document.getElementById('debug-text');
            debugText.innerHTML += '<br>' + new Date().toLocaleTimeString() + ': ' + message;
            console.log(message);
        }
        
        function testShowLogin() {
            log('üîÑ Testing show login...');
            if (window.authPopup && window.authPopup.isInitialized) {
                window.authPopup.show('login');
                log('‚úÖ Login popup shown');
            } else {
                log('‚ùå AuthPopup not ready: ' + JSON.stringify({
                    exists: !!window.authPopup,
                    initialized: window.authPopup?.isInitialized
                }));
            }
        }
        
        function testShowForgotPassword() {
            log('üîÑ Testing show forgot password direct...');
            if (window.authPopup && window.authPopup.isInitialized) {
                window.authPopup.show('forgot-password');
                log('‚úÖ Forgot password popup shown');
            } else {
                log('‚ùå AuthPopup not ready');
            }
        }
        
        function testClickForgotLink() {
            log('üîÑ Testing forgot password link click...');
            const forgotLink = document.getElementById('forgot-password-link');
            if (forgotLink) {
                log('‚úÖ Found forgot link, triggering click');
                forgotLink.click();
            } else {
                log('‚ùå Forgot password link not found');
            }
        }
        
        function debugElements() {
            log('üîç Debugging elements...');
            const elements = {
                authPopup: !!document.getElementById('auth-popup'),
                forgotTab: !!document.getElementById('forgot-tab'),
                forgotForm: !!document.getElementById('forgot-password-form'),
                forgotLink: !!document.getElementById('forgot-password-link'),
                loginForm: !!document.getElementById('login-form'),
                tabUnderline: !!document.getElementById('tab-underline')
            };
            log('Elements status: ' + JSON.stringify(elements, null, 2));
            
            if (window.authPopup) {
                log('AuthPopup status: ' + JSON.stringify({
                    initialized: window.authPopup.isInitialized,
                    currentTab: window.authPopup.currentTab
                }));
            }
        }
        
        function testInitAuth() {
            log('üöÄ Testing auth initialization...');
            if (window.authPopup) {
                window.authPopup.init().then(() => {
                    log('‚úÖ Auth popup initialized successfully');
                }).catch(err => {
                    log('‚ùå Failed to initialize: ' + err.message);
                });
            } else {
                log('‚ùå window.authPopup not found');
            }
        }
    </script>
    
    <!-- Load auth popup script -->
    <script src="./components/auth-popup.js"></script>
    
    <!-- Include the auth popup HTML -->
    <style>
    /* Force no background on auth tabs */
    #login-tab, #register-tab, #forgot-tab {
        background: transparent !important;
        background-color: transparent !important;
        background-image: none !important;
        border: none !important;
        box-shadow: none !important;
        outline: none !important;
    }
    </style>
    
    <div id="auth-popup" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 70; display: none; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s ease;">
      <div id="auth-popup-content" style="background: #1a1f2e; border-radius: 16px; width: 520px; height: auto; min-height: 600px; position: relative; transform: scale(0.9); transition: transform 0.3s ease; box-sizing: border-box; padding: 40px;">
        
        <!-- Tab Headers -->
        <div style="display: flex; justify-content: space-between; margin-bottom: 40px; position: relative; width: 100%;">
          <!-- Login Tab -->
          <button id="login-tab" style="background: transparent !important; color: #5b5ff7; border: none !important; padding: 12px 0; font-family: 'Inter'; font-weight: 600; font-size: 18px; cursor: pointer; transition: color 0.3s ease; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex: 1; text-align: center; box-shadow: none !important;">
            Login
          </button>
          
          <!-- Register Tab -->
          <button id="register-tab" style="background: transparent !important; color: #9CA3AF; border: none !important; padding: 12px 0; font-family: 'Inter'; font-weight: 600; font-size: 18px; cursor: pointer; transition: color 0.3s ease; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex: 1; text-align: center; box-shadow: none !important;">
            Register
          </button>
          
          <!-- Forgot Password Tab (Hidden by default) -->
          <button id="forgot-tab" style="background: transparent !important; color: #9CA3AF; border: none !important; padding: 12px 0; font-family: 'Inter'; font-weight: 600; font-size: 16px; cursor: pointer; transition: color 0.3s ease; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex: 1; text-align: center; box-shadow: none !important; display: none;">
            Reset Password
          </button>
          
          <!-- Active tab underline -->
          <div id="tab-underline" style="position: absolute; bottom: -10px; left: 0; width: 50%; height: 3px; background: #5b5ff7; transition: all 0.3s ease;"></div>
        </div>

        <!-- Close Button -->
        <button id="close-auth-popup" style="position: absolute; top: 16px; right: 16px; width: 32px; height: 32px; background: rgba(156, 163, 175, 0.2); border: none; border-radius: 50%; color: #9CA3AF; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: all 0.2s ease;">
          √ó
        </button>

        <!-- Login Form -->
        <div id="login-form" style="width: 100%;">
          <h2 style="text-align: center; margin: 0 0 40px 0; font-family: 'Inter'; font-weight: 700; font-size: 32px; color: #FFFFFF;">Welcome Back</h2>
          
          <div id="login-error" style="display: none; padding: 12px; margin-bottom: 20px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; color: #F87171; font-family: 'Inter'; font-size: 14px; text-align: center;"></div>
          
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF;">Email</label>
            <div style="position: relative; background: #2a3441; border-radius: 8px; overflow: hidden;">
              <input id="login-email" type="email" placeholder="your@email.com" style="width: 100%; padding: 16px; background: transparent; border: none; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF; outline: none; box-sizing: border-box;">
            </div>
          </div>

          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF;">Password</label>
            <div style="position: relative; background: #2a3441; border-radius: 8px; overflow: hidden;">
              <input id="login-password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width: 100%; padding: 16px; background: transparent; border: none; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF; outline: none; box-sizing: border-box;">
            </div>
          </div>

          <div style="text-align: right; margin-bottom: 32px;">
            <a href="#" id="forgot-password-link" style="font-family: 'Inter'; font-weight: 400; font-size: 14px; color: #5b5ff7; text-decoration: none;">Forgot password?</a>
          </div>

          <button id="sign-in-btn" style="width: 100%; padding: 16px; background: linear-gradient(90deg, #8b5cf6 0%, #5b5ff7 100%); border-radius: 8px; border: none; cursor: pointer; margin-bottom: 24px;">
            <span style="font-family: 'Inter'; font-weight: 600; font-size: 16px; color: #FFFFFF;">Sign In</span>
          </button>
        </div>

        <!-- Register Form -->
        <div id="register-form" style="display: none; width: 100%;">
          <h2 style="text-align: center; margin: 0 0 40px 0; font-family: 'Inter'; font-weight: 700; font-size: 32px; color: #FFFFFF;">Create Account</h2>
          <div id="register-error" style="display: none; padding: 12px; margin-bottom: 20px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; color: #F87171; font-family: 'Inter'; font-size: 14px; text-align: center;"></div>
        </div>

        <!-- Forgot Password Form -->
        <div id="forgot-password-form" style="display: none; width: 100%;">
          <h2 style="text-align: center; margin: 0 0 40px 0; font-family: 'Inter'; font-weight: 700; font-size: 32px; color: #FFFFFF;">Reset Password</h2>
          
          <div id="forgot-error" style="display: none; padding: 12px; margin-bottom: 20px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; color: #F87171; font-family: 'Inter'; font-size: 14px; text-align: center;"></div>
          <div id="forgot-success" style="display: none; padding: 12px; margin-bottom: 20px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 8px; color: #4ADE80; font-family: 'Inter'; font-size: 14px; text-align: center;"></div>
          
          <div id="email-step" style="width: 100%;">
            <p style="text-align: center; margin-bottom: 24px; font-family: 'Inter'; font-size: 14px; color: #9CA3AF; line-height: 1.5;">Enter your email address and we'll send you a verification code to reset your password.</p>
            
            <div style="margin-bottom: 32px;">
              <label style="display: block; margin-bottom: 8px; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF;">Email</label>
              <div style="position: relative; background: #2a3441; border-radius: 8px; overflow: hidden;">
                <input id="forgot-email" type="email" placeholder="your@email.com" style="width: 100%; padding: 16px; background: transparent; border: none; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF; outline: none; box-sizing: border-box;">
              </div>
            </div>

            <button id="send-code-btn" style="width: 100%; padding: 16px; background: linear-gradient(90deg, #8b5cf6 0%, #5b5ff7 100%); border-radius: 8px; border: none; cursor: pointer; margin-bottom: 24px;">
              <span style="font-family: 'Inter'; font-weight: 600; font-size: 16px; color: #FFFFFF;">Send Verification Code</span>
            </button>
          </div>

          <div id="verification-step" style="display: none; width: 100%;">
            <p style="text-align: center; margin-bottom: 24px; font-family: 'Inter'; font-size: 14px; color: #9CA3AF;">Enter the 6-digit verification code sent to your email.</p>
            
            <div style="margin-bottom: 32px;">
              <label style="display: block; margin-bottom: 8px; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF;">Verification Code</label>
              <div style="position: relative; background: #2a3441; border-radius: 8px; overflow: hidden;">
                <input id="verification-code" type="text" placeholder="123456" maxlength="6" style="width: 100%; padding: 16px; background: transparent; border: none; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF; outline: none; box-sizing: border-box; letter-spacing: 2px;">
              </div>
            </div>

            <button id="verify-code-btn" style="width: 100%; padding: 16px; background: linear-gradient(90deg, #8b5cf6 0%, #5b5ff7 100%); border-radius: 8px; border: none; cursor: pointer; margin-bottom: 16px;">
              <span style="font-family: 'Inter'; font-weight: 600; font-size: 16px; color: #FFFFFF;">Verify Code</span>
            </button>

            <button id="resend-code-btn" style="width: 100%; padding: 12px; background: transparent; border: 1px solid #5b5ff7; border-radius: 8px; cursor: pointer; margin-bottom: 24px;">
              <span style="font-family: 'Inter'; font-weight: 500; font-size: 14px; color: #5b5ff7;">Resend Code</span>
            </button>
          </div>

          <div id="password-revealed-step" style="display: none; width: 100%;">
            <p style="text-align: center; margin-bottom: 24px; font-family: 'Inter'; font-size: 14px; color: #4ADE80;">Verification successful! Here is your password:</p>
            
            <div style="margin-bottom: 32px;">
              <label style="display: block; margin-bottom: 8px; font-family: 'Inter'; font-weight: 400; font-size: 16px; color: #9CA3AF;">Your Password</label>
              <div style="position: relative; background: #2a3441; border-radius: 8px; overflow: hidden; border: 2px solid #4ADE80;">
                <input id="revealed-password" type="text" readonly style="width: 100%; padding: 16px 52px 16px 16px; background: transparent; border: none; font-family: 'Inter'; font-weight: 600; font-size: 16px; color: #4ADE80; outline: none; box-sizing: border-box; text-align: center; letter-spacing: 1px;">
                <button id="copy-password-btn" type="button" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #4ADE80;">Copy</button>
              </div>
            </div>

            <button id="back-to-login-btn" style="width: 100%; padding: 16px; background: linear-gradient(90deg, #8b5cf6 0%, #5b5ff7 100%); border-radius: 8px; border: none; cursor: pointer; margin-bottom: 24px;">
              <span style="font-family: 'Inter'; font-weight: 600; font-size: 16px; color: #FFFFFF;">Back to Login</span>
            </button>
          </div>
        </div>

      </div>
    </div>

    <script>
        // Initialize immediately after DOM content is ready
        document.addEventListener('DOMContentLoaded', () => {
            log('üìã DOM loaded, initializing auth popup...');
            
            if (window.authPopup) {
                window.authPopup.init().then(() => {
                    log('‚úÖ Auth popup initialized successfully');
                    debugElements();
                }).catch(err => {
                    log('‚ùå Failed to initialize auth popup: ' + err.message);
                });
            } else {
                log('‚ùå window.authPopup not found');
                setTimeout(() => {
                    if (window.authPopup) {
                        log('üîÑ Retrying auth popup initialization...');
                        window.authPopup.init();
                    }
                }, 1000);
            }
        });
    </script>
</body>
</html>
